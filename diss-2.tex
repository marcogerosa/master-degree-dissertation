%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\parindent}{0pt}
\setlength{\textheight}{22cm}
\setlength{\parskip}{0.2cm}

% Para aumentar o espaçamento entre as linhas
\linespread{1.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Modelo para planejamento}
\label{cap:modelo_conceitual_planejamento}

At vero eos et accusamus et iusto odio dignissimos ducimus\index{ducimus},  qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus. Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus, ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus asperiores repellat..

\section{Modelo conceitual para planejamento}

At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident.\\

\begin{Def}[Sistema de transição de estados]
Um sistema de transição de estados é uma 4-tupla $\Sigma\ =\ (\mathcal{S},\ \mathcal{A},\ \mathcal{E},\ \gamma)$ \cite{Malik2004}:

\begin{itemize}

\item $\mathcal{S}\ =\ \{s_1,\ s_2,\ \ldots\}$ é um conjunto finito de estados, recursivamente numerável;

\item $\mathcal{A}\ =\ \{a_1,\ a_2, \ \ldots\}$ é um conjunto finito de ações, recursivamente numerável;

\item $\mathcal{E}\ =\ \{e_1,\ e_2, \ \ldots\}$ é um conjunto finito de eventos, recursivamente numerável, que aqui serão chamados de {\it ações exógenas\index{ação!exógena}} (ou {\it eventos exógenos\index{evento!exógeno}}); 

\item $\gamma:\ \mathcal{S}\ \times\  \mathcal{A}\ \times\ \mathcal{E}\ \to\ 2^s$ é uma função de transição de estado.

\end{itemize}

\end{Def}

At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident.

\begin{figure}[ht!]
	\centering
	\includegraphics[scale=0.80]{./img/grafo_transicao_estado.ps}
	\caption[Exemplo de sistema de transição de estado]{Exemplo de sistema de transição de estados.}
	\label{fig:sistemaTransicaoEstado}
\end{figure}

At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident.

{\it Eventos \index{evento}} são transições {\it contingentes} \index{transição!contingente}, aqui chamados de eventos exógenos\index{evento!exógeno} (ou ações exógenas\index{ação!exógena}), isto é, ações que não são controladas pelo executor do plano. Estas ações devem ser levadas em conta pelo agente de planejamento, mas não estão sob seu controle. Se $e$ é um evento e $\gamma(s,e)$ não é vazio, então $e$ possivelmente ocorrerá quando o sistema estiver no estado $s$; e sua ocorrência em $s$ levará o sistema a algum estado em $\gamma(s,e)$. Como o estado exato não pode ser previsível pelo agente planejador, dizemos que este é um tipo de planejamento sob incerteza. \\
%\footnote{Eventos exógenos podem também ser modelados. Porém, neste trabalho, o agente planejador não possui representação interna deste modelo} \\ 

Podem existir vários modelos que definem a semântica da função de transição\index{função!de transição} $\gamma:\ \mathcal{S}\ \times\ \mathcal{A}\ \times\ \mathcal{E}\ \to\ 2^s$. O modelo de Markov\index{modelo!de Markov} supõe que nenhuma ação possa ser executada em estados em que ocorram eventos e vice-versa. Deste modo, $\mathcal{S}$ é dividido em {\it estados de ação\index{estado!de ação}} e {\it estados de evento\index{estado!de evento}} \cite{Sven1995}. Um modelo alternativo supõe que ações possam competir com eventos no mesmo estado. Isto é, se for aplicada a ação $a$ ao estado $s$ e $\gamma(s,e)$ não é vazio, então o próximo estado pode ser qualquer elemento de $\gamma(s,a,e)$. \\

Dado um sistema de transição\index{sistema!de transição} de estado $\Sigma$, o propósito do planejamento é selecionar uma seqüência de ações que, quando executadas no estado inicial, permitam alcançar um objetivo. Chama-se de {\it plano\index{plano}} a estrutura que representa a seqüência de ações. O objetivo pode ser especificado de várias formas diferentes:

\begin{itemize}

\item As especificações mais simples consistem em um {\it estado-objetivo} $s_g$ ou um conjunto de estados objetivo\index{estado!objetivo} $S_g$. Neste caso, o objetivo é alcançado quando qualquer se\-qüên\-ci\-a de transições de estado termina em um dos estados-objetivo.

\item O objetivo pode satisfazer alguma condição de acordo com a se\-qüên\-ci\-a de estados a ser seguida pelo sistema. Por exemplo, exigir que estados sejam evitados, especificar estados em que o sistema deverá passar necessariamente durante a execução do plano e estados nos quais ele deverá permanecer.

\item Em alguns domínios é possível definir uma função de utilidade\index{função!de utilidade} ligada aos estados, com penalidades\index{penalidades} e recompensas\index{recompensas}. Nesse caso o objetivo é otimizar alguns componentes da função destas utilidades (por exemplo, soma ou máximo) conforme a se\-qüên\-ci\-a de estados seguidos pelo sistema.

\item Outra alternativa é especificar o objetivo como tarefas\index{tarefa} que o sistema deverá executar. Estas tarefas podem ser recursivamente decompostas como conjuntos de ações mais simples.

\end{itemize}

A Figura 2.2
%TODO: ~\ref{fig:modeloConceitualPlanejamento} 
mostra um modelo conceitual do uso de um planejador em um ambiente. Este modelo é descrito por meio da interação entre três componentes:

\begin{enumerate}

\item O {\it ambiente\index{ambiente}} denominado $\Sigma$ possui uma dinâmica que pode ser modelada por meio da função de transição\index{função!de transição} de estado $\gamma$, de acordo com a ocorrência dos eventos e das ações.

\item Um {\it controlador\index{controlador}}, dado como entrada a observação do estado em que se encontra o sistema e um plano, fornece como saída uma ação $a$.

\item Um {\it planejador\index{planejador}} que, dado como entrada um modelo do ambiente $\Sigma$\footnote{No decorrer do texto o modelo do ambiente $\Sigma$ será tratado apenas por ambiente $\Sigma$ ou, algumas vezes, por sistema $\Sigma$ (de transição de estado).} (domínio), um estado inicial\index{estado!inicial} e um objetivo, sintetiza um plano que satisfaz o objetivo.

\end{enumerate}

\begin{figure}[ht!]
	\centering
	\includegraphics[scale=0.80]{./img/modelo_planejamento.ps}
	\caption[Modelo conceitual para planejamento]{Modelo conceitual para planejamento \cite{Malik2004}.}
	\label{fig:modeloConceitualPlanejamento}
\end{figure}

\subsection{Modelo conceitual para planejamento dinâmico}

Um elemento importante deste modelo é a observação\index{observação} do controlador sobre o estado atual do sistema durante a execução de um plano. Em geral, esta informação não é completa. O conhecimento parcial sobre o estado pode ser modelado como uma função de observação\index{função!observação} $\eta:\ \mathcal{S}\ \to\ \mathcal{O}$, que mapeia $\mathcal{S}$ em um conjunto discreto $\mathcal{O}\ =\ \{o_1,\ o_2,\ \ldots\}$ de observações possíveis. \\

Neste modelo, o controlador executa suas tarefas com a dinâmica do sistema de transição de estado e, portanto, diz-se que ele funciona {\it online} com o ambiente. Por outro lado, o planejador não está diretamente conectado ao ambiente (funcionamento {\it offline\index{offline}}).\\
%TODO: ~\ref{fig:modeloConceitualPlanejamento}. \\


Na maior parte das vezes, há diferenças entre o sistema físico\index{sistema!físico} ($\Sigma$) a ser controlado e seu modelo. Em geral, o planejamento depende das restrições\index{restrições} impostas pelo modelo\index{modelo} de $\Sigma$. Supõe-se que o controlador seja robusto o suficiente para lidar com as diferenças entre $\Sigma$ e o mundo real\index{mundo!real}. Lidar com observações exige mecanismos de controle mais complexos do que apenas identificar o estado e aplicar a ação correspondente. Um modelo conceitual mais realista intercala planejamento com execução e mecanismos de replanejamento\index{replanejamento} ou reparo de plano\index{reparo!de plano}. Neste caso é necessária uma ligação mais próxima entre o planejador e o controlador: o controlador deve ser capaz de devolver ao planejador o status da execução do planejamento a fim de comunicar eventuais falhas\index{falha} no plano, como é ilustrado na Figura 2.3 por meio da ligação entre controlador e planejador, rotulada por {\it status de execução}.\\
%TODO: ~\ref{fig:modeloConceitualPlanejamentoDinamico}. \\

\begin{figure}[ht!]
	\centering
	\includegraphics[scale=0.80]{./img/modelo_planejamento_dinamico.ps} 
	\label{fig:modeloConceitualPlanejamentoDinamico}
	\caption[Modelo conceitual para planejamento com execução]{Modelo conceitual para planejamento com execução \cite{Malik2004}.}
\end{figure} 

Neste trabalho será implementado um sistema que ora funcionará como um sistema de planejamento, quando ainda não existir um plano, ora como um sistema de reparo, que dependerá da informação transmitida pelo controlador (status de execução). Esta informação poderá ser de dois tipos:

\begin{enumerate}
 \item O plano foi executado inteiramente com sucesso.

\item O plano foi parcialmente executado e, nesse caso, o mesmo é devolvido com as indicações das ações que já foram realizadas e da ação cuja execução falhou. 
\end{enumerate}

No caso de falha (caso 2), o sistema de reparo é então chamado para: (1) adicionar ações ou (2) remover ações do plano a fim de torná-lo novamente executável, garantindo que este atinja as metas originais com pequenas alterações.