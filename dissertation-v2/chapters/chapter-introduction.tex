% -*- root: dissertation.tex -*-



% Qualidade de código já se provou com uma área de extrema importância no desenvolvimento de software e o rápido surgimento de novas tecnologias faz com que esta área continue muito relevante \todo{refs aqui}. Android é uma dessas novas tecnologias que surgiu na última década e tem apresentado um crescimento extremamente acentuado \todo{refs aqui}. Porém, estudos sobre qualidade de código Android ainda são poucos \todo{refs aqui}. 

% Uma das formas que desenvolvedores tem para aumentar a qualidade de seus códigos é por meio de refatoração. Refatoração é, segundo Kent Beck \todo{ref Refactoring}, uma alteração feita na estrutura interna do software para torná-lo mais fácil de ser entendido e menos custoso de ser modificado sem alterar seu comportamento observável. Entretanto, uma parte importante para ser possível realizar refatorações é encontrar trechos códigos que precisem ser refatorados. Para isso é comum a identificação de maus cheiros no código. 

% O termo mau cheiro foi definido pela primeira vez no livro Refactoring de Martin Fowler com a participação de Kent Beck. Um mau cheiro de código descreve um contexto no código que pode apontar, ou não, para um problema mais profundo, mas geralmente não é o problema em si e não significa que existe alguma falha sistêmica. Trechos de código ``maus cheirosos'' são fortes candidatos a passarem por refatorações.

% Nesta pesquisa investigamos a existência de maus cheiros de código específicos a plataforma Android.


\todo{Trocar códigos por trecho de código e software por sistema de software - revisor do artigo}

\todo{Por que vocês resolveram incluir maus cheiros tradicionais na avaliação? Que maus cheiros tradicionais foram levados em conta? Como vocês determinaram os códigos que tinham maus cheiros tradicionais? - revisor do artigo}


No dia a dia, é muito comum desenvolvedores se apoiarem em boas práticas clássicas de software para desenvolverem seus códigos com mais qualidade, e certamente existem muitas \cite{Webster:95, GoF:95, Riel:96, AntiPatterns:98, Refactoring:99, CoreJ2EE:03, CleanCode:08, Rozanski:12, Refactoring:14}. Mas nos tempos atuais, novas tecnologias surgem muito rapidamente e com elas, novos desafios que eventualmente as boas práticas do passado podem não ser o suficiente. Quando isso ocorre, é comum desenvolvedores criarem, a partir de suas próprias experiências e vivências, seu arsenal pessoal de boas práticas de desenvolvimento nessas tecnologias. Alguns chegam a compartilhar essas boas práticas via postagens em seus blogs pessoais, artigos, livros e outros. Não compartilhar é um grande problema pois, outros desenvolvedores que venham a enfrentar os mesmos desafios, não terão acesso a este conhecimento e poderão vir a repetir falhas que outros, já encontraram melhores formas de lidar.

Se analisarmos a origem das boas práticas clássicas, veremos que elas surgiram exatamente a partir do conhecimento empírico de desenvolvedores experientes. Webster \cite{Webster:95} afirma no seu livro que está documentando como não cair em \emph{armadilhas} no desenvolvimento de software que ele aprendeu ao longo de 20 anos, Martin \cite{CleanCode:08} faz o mesmo, documentando práticas que ele diz ajudar a manter o \emph{código limpo}, onde ele mesmo afirma que não é a verdade absoluta, e sim, um conjunto de práticas que ele aprendeu ao longo de anos de desenvolvimento de software que o ajudaram nesta tarefa de escrever código de qualidade e que acredita poder ajudar muitos outros desenvolvedores.

O Android é uma dentre as tecnologias que surgiram na última década, mais precisamente há 9 anos. Seu crescimento acelerado, o tornou a principal plataforma para desenvolvimento móvel. Mais de 83,5\% dos dispositivos móveis no mundo usam o sistema operacional Android, e esse percentual vem crescendo ano após ano \cite{MobileMarketShares:16, GrowthForecastIDC:16}. Entretanto, o Android é ainda uma plataforma jovem se compararmos por exemplo, com Java, plataforma mais usada nas últimas décadas e que existe há mais de 20 anos. Desta forma, enquanto que existem diversas pesquisas e literaturas que tratam de boas práticas no desenvolvimento Java e orientado a objetos, são poucas as que tratam de boas práticas no desenvolvimento Android. Umme et al. \cite{Mannan_Dig_Ahmed_Jensen_Abdullah_Almurshed} recentemente levantaram que no período de 2008 a 2015, nas principais conferências de manutenção de software (ICSE, FSE, OOPSLA/SPLASH, ASE, ICSM/ICSME, MRS e ESEM) apenas 10\% dos artigos consideraram projetos Android em suas pesquisas e nenhuma outra plataforma móvel foi considerada.

Podemos fazer um paralelo do desenvolvimento Android com o desenvolvimento Java web. Uma aplicação Java web normalmente é divida em \textit{back-end}, \todo{breve definição}, e \textit{front-end}, \todo{breve definição}. O \textit{back-end} de aplicação Java web é composto basicamente por código Java, desta mesma forma é feito no desenvolvimento Android. No desenvolvimento do \textit{front-end} de aplicações web são comumente usadas as linguagens HTML e CSS para criação da tela e Javascript para responder a eventos do usuário. No Android encontramos XML e Java para construção de tela, chamada de \texttt{Activity}, e novamente Java para responder a eventos do usuário. O dialeto usado nos arquivos XML são específicos do Android e as classes Java necessitam obrigatoriamente herdar de classes do Android SDK. 

Podemos observar que o desenvolvimento do \textit{front-end} tanto de aplicações Java web quanto de Android se difere do desenvolvimento do \textit{back-end}. Escrever código de qualidade é importante tanto no \textit{back-end} quanto no \textit{front-end}. Encontramos diversas pesquisas focadas em tecnologias usadas especificamente no \textit{front-end} web, como CSS \cite{CSSCodeSmell} e Javascript \cite{JavascriptSmells} e acreditamos que pesquisas focadas no desenvolvimento do \textit{front-end} Android também são necessárias. Aniche et al. \cite{MvcSmells:16} derivam 6 maus cheiros específicos ao arcabouço Spring MVC, \todo{breve descrição}, e apontam a relevância de se pesquisar sobre qualidade de código específicas a uma tecnologia. Eles afirmam que a arquitetura do software é um fator importante e que deve ser levado em conta ao analisar a qualidade de um sistema.

Dentre as pesquisas sobre Android, muitas chegam a conclusão que as classes mais afetadas por maus cheiros tradicionais são \texttt{Activities} e \texttt{Adapters} [??]. \todo{dar um ou dois exemplos dessas conclusões de forma breve}. Essas conclusões reforçam nossa hipótese de que o desenvolvimento do \textit{front-end} Android possui peculiaridades que precisam ser melhor investigadas. Além disso, o código relacionado ao front-end em apps Android representam o maior percentual de código na aplicação, ou seja, melhorar a qualidade deste tipo de código significa melhor a qualidade da maior parte do aplicativo.

Dentre os estudos já realizados sobre qualidade de código Android, podemos encontrar alguns buscando por maus cheiros tradicionais, como os definidos por Martin Fowler \cite{Refactoring:99}, em projetos Android e outros buscando por maus cheiros específicos a plataforma Android. Estudos que buscaram relacionar de alguma forma maus cheiros tradicionais em projetos Android são, por exemplo, o estudo de Linares et al. \cite{DomainMatters} que tentam detectar 18 \textit{anti-patterns} tradicionais em aplicativos móveis. Verloop \cite{MobileSmells:13} analisou se classes derivadas do SDK Android, conjunto de clases base para o desenvolvimento Android, são mais ou menos propensas a apresentar os maus cheiros tradicionais do que classes núcleo, que não precisam herdar de classes do Android SDK. Estudos que buscaram por maus cheiros específicos ao contexto Android são, por exemplo, de Fulano \todo{arrumar} \cite{RemovingEnergySmells:12, ReimannBrylski2013} que identificaram cheiros de código específicos Android relacionados ao consumo inteligente de recursos do dispositivo, como bateria e memória, usabilidade, dentre outros. 


Por fim, catalogamos 16 maus cheiros Android relacionados a manutenibilidade de código do \textit{front-end} Android, extraídos através de 2 questionários online e 3 rodadas de um mesmo experimento contanto com a participação de mais de 3XX respondentes de todos o mundo.

\section{Motivação}


\section{Questões de Pesquisa}
% Abordagem de Solução pq abordou dessa forma? Está tentando responder quais perguntas?

Esta dissertação tem como objetivo investigar a existência de maus cheiros específicos ao \textit{front-end} Android. 

Maus cheiro são sintomas que podem indicar um problema mais profundo no código \cite{Refactoring:99}. Geralmente são derivados da experiência e opinião de desenvolvedores \cite{JavaQADetectingSmells:02} ou seja, são por natureza subjetivos \cite{JavascriptSmells}. Há evidências na literatura que sugerem que maus cheiros são percebidos por desenvolvedores \cite{Palomba_Do_2014}. Desta forma, formulamos três questões de pesquisa: \\


\textbf{QP1: Existem maus cheiros que são específicos ao \textit{front-end} Android?}


Como principal questão de pesquisa, objetiva investigar a existência de maus cheiros no desenvolvimento do \textit{front-end} Android e caso existam, documentá-los. Para isso precisamos explorar o conhecimento empírico de desenvolvedores Android \cite{JavascriptSmells, JavaQADetectingSmells:02}, tarefa que exige alguns passos, portanto dividimo esta questão em outras duas a seguir:

% e contempla a execução de alguns passos para que possa ser respondida. Precisamos coletar informações empíricas de desenvolvedores sobre o desenvolvimento do \textit{front-end} Android,a partir destas informações, investigar a existência de más práticas recorrentes e se existirem, derivar possíveis maus cheiros. Para isso, derivamos três sub-ques


\textbf{QP1.1:} O que desenvolvedores consideram boas e más práticas no desenvolvimento do \textit{front-end} Android? \\
Esta é uma importante questão a ser respondida pois nos fornece as primeiras ideias sobre maus cheiros no \textit{front-end} Android a partir da perspectiva de desenvolvedores praticantes. Fizemos isso através de um questionário online submetido a desenvolvedores Android perguntando-os sobre o que eles consideram boas e más práticas em oito dos elementos usados para desenvolvimento do \textit{front-end} Android e recebemos um total de 45 respostas.

\textbf{QP1.2.} Existem boas e más práticas recorrentes, e portanto elegíveis para a derivação de maus cheiros?\\
Com o resultado, realizamos um processo de codificação pelo qual buscamos por más práticas recorrentes de forma a ser a base para derivação dos maus cheiros. Esse processo resultou em 46 categorias das quais, 21 apresentaram-se recorrente o suficiente \cite{NielsenMagicNumber:00} para serem consideradas para derivação dos maus cheiros. A partir dessas 21 categorias, extraímos 21 maus cheiros no \textit{front-end} Android. 

% \textbf{QP1.3.} Quais maus cheiros podemos derivar a partir das boas e más práticas coletadas?\\
% A partir das 21 categorias recorrentes, extraímos 21 maus cheiros no \textit{front-end} Android. 

\begin{center}
\textbf{QP2. Quais maus cheiros são vistos com mais frequência e quais são considerados mais importantes?}
\end{center}

% Entretanto, precisamos validar com desenvolvedores se os sintomas documentados são percebidos no dia a dia de desenvolvimento e se são considerados pontos importantes a se evitar no código. Para isso, elaboramos a seguinte pergunta:

Com o objetivo de validar os maus cheiros derivados da questão anterior, perguntamos a desenvolvedores Android se eles percebiam os maus cheiros no seu dia a dia e o quão importante eles consideravam mitigar a situação apresentada pelo mau cheiro. Obtivemos 201 respostas dos quais validamos positivamente que 16 maus cheiros são considerados importantes e percebidos frequentemente no dia a dia. Dos 21, foram desconsiderados 5 maus cheiros por não serem considerados tão importantes ou tão frequentes.

\begin{center}
\textbf{QP3. Desenvolvedores Android percebem os códigos afetados pelos maus cheiros como problemáticos?}
\end{center}

Evidências na literatura sugerem que maus cheiros são percebidos por desenvolvedores \cite{Palomba_Do_2014}. A fim de validar a percepção dos maus cheiros pelos desenvolvedores Android, realizamos um experimento de código com 75 desenvolvedores. Com os resultados pudemos validar estatisticamente a percepção dos desenvolvedores sobre 13 dos 16 maus cheiros, são eles:


% onde apresentamos randomicamente códigos Android afetados pelos maus cheiros e códigos limpos e perguntávamos a cada código, se o participante percebia aquele código como problemático, se sim, qual a gravidade do problema e qual o problema percebido. Ao final deste processo descartamos mais 3 maus cheiros pois não se mostraram percebidos por desenvolvedores e concluímos com 19. A partir deste experimento extraímos análises estatísticas que confirmaram a percepção de desenvolvedores com relação aos maus cheiros identificados.


% Por fim, catalogamos 16 maus cheiros Android relacionados a manutenibilidade de código do \textit{front-end} Android, extraídos através de 2 questionários online e 3 rodadas de um mesmo experimento contanto com a participação de mais de 3XX respondentes de todos o mundo.


% Iniciamos nossa pesquisa com algumas hipóteses de quais práticas poderiam ser consideradas más práticas, e portanto exalando um mau cheiro no desenvolvimento do \textit{front-end} Android. Uma dessa situações hipotéticas foi, por exemplo, o uso de textos, cores e tamanhos diretamente no XML de layout, sem a criação de um novo recurso, respectivamente nos arquivos \texttt{strings.xml}, \texttt{colors.xml} ou \texttt{dimens.xml}. 

% Para extrair as ideias iniciais da pesquisa aplicamos um questionário online onde perguntávamos para desenvolvedores Android sobre boas e más práticas utilizadas no dia a dia. Obtivemos 45 respostas e pudemos extrair 50 boas e más práticas que resultaram em 25 maus cheiros de código Android.

\section{Contribuições}
% Objetivo

% Nossa hipótese de pesquisa é que existem maus cheiros de código específicos ao Android. Nossa pesquisa complementa as anteriores no sentido de que também buscamos por maus cheiros Android. E se difere delas pois buscamos maus cheiros relacionados à qualidade de código. Por exemplo \textsc{Activities}, \textsc{Fragments} e \textsc{Adapters} são classes usadas na construção de telas e \textsc{listeners} são responsáveis pelas interações com os usuários. Buscamos entender então quais são as \emph{boas e más} práticas no desenvolvimento da interface visual de aplicativos Android. 

% Esta pesquisa tem por objetivo identificar e documentar maus cheiros de código específicos a plataforma móvel Android a fim de servir como mais uma ferramenta para desenvolvedores Android que buscam aumentar a qualidade de seus códigos nessa plataforma pois aqui estará documentado o conhecimento empírico de mais de 300 desenvolvedores Android experientes.

As principais contribuições desta pesquisa são:

\begin{enumerate}
  \item Catálogo com 13 \todo{acertar número após experimento} maus cheiros específicos ao \textit{front-end} Android derivados a partir da opinião de mais de 300 desenvolvedores Android praticantes, por meio de dois questionários online e um experimento em 3 fases. 

  Estes catálogo pode servir a outros pesquisadores e praticantes. Aos pesquisadores serve como ponto de partida para a definição de heurísticas e implementação de ferramentas que identifiquem estes maus cheiros automaticamente. Aos praticantes serve como indicadores de situações a serem evitadas ou refatoradas, mesmo que ainda de forma manual.

  \item A percepção de desenvolvedores Android com relação aos maus cheiros catalogados.

  \item Apêndice online~\cite{apendice} com informações detalhadas dos questionários e outras informações da pesquisa para que outros pesquisadores possam replicar nosso estudo.
\end{enumerate}

\section{Originalidade e Relevância}


Estudos identificaram cheiros de código específicos Android relacionados ao consumo inteligente de recursos do dispositivo, como bateria e memória, usabilidade, dentre outros \cite{RemovingEnergySmells:12, ReimannBrylski2013}. Verloop \cite{MobileSmells:13} analisou se classes derivadas do SDK Android são mais ou menos propensas a cheiros de código tradicionais do que classes puramente Java. Linares et al. \cite{DomainMatters} usaram o método DECOR para realizar a detecção de 18 \textit{anti-patterns} orientado a objetos em aplicativos móveis.

\todo{A maior parte dos maus cheiros são introduzidos no começo do projeto, logo identifica-los após o primeiro lançamento é de grande valia para ajudar a evoluir a qualidade}

Escrever código com qualidade tem se tornado cada vez mais importante com o aumento da complexidade de tecnologias e anseio dos usuários por novas funcionalidade e atualizações \cite{Hecht:15, MobileSmells:13}. Existem diferentes práticas, padrões e ferramentas que auxiliam os desenvolvedores a escrever código com qualidade, incluindo \textit{design patterns} \cite{GoF:95} e maus cheiros \cite{Refactoring:99}. Evidências na literatura sugerem que maus cheiros podem dificultar a manutenibilidade do código \cite{Yamashita:2013:EII:2486788.2486878, Yamashita6405287, Sjoberg_Quantifying_2013} e a falta de qualidade pode resultar em defeitos de software que custam a empresas quantias significativas, especialmente quando conduzem a falhas de software \cite{Nagappan:2005, briand1993modeling}. Evolução e manutenção de software também já se provaram como os maiores gastos com aplicações \cite{RefactoringAndImprovements:10}.

Uma das formas de aumentar a qualidade de software é identificar trechos de códigos ruins e refatorá-los, ou seja, alterar o código sem alterar o comportamento \cite{Refactoring:99}. Desta forma, temos que cheiros de código são aliados importantes na busca por qualidade de código pois, representam sintomas que podem indicar problemas mais profundos no software, não necessariamente, sendo o problema em si \cite{CodeSmell:06}. Seu mapeamento possibilita a definição de heurísticas que, por sua vez, possibilitam a implementação de ferramentas que os identificam de modo automático no código. PMD \cite{PMD2016}, Checkstyle e FindBugs são exemplos de ferramentas que identificam automaticamente alguns maus cheiros em projetos Java. 

Enquanto que maus cheiros em projetos Java já foram extensivamente estudados \cite{Riel:96, Refactoring:99, CleanCode:08}, ainda há muito a se pesquisar sobre cheiros de código em projetos Android. No entanto, determinar o que é ou não um cheiro de código é subjetivo e pode variar de acordo com a tecnologia, desenvolvedor, metodologia de desenvolvimento dentre outros aspectos \cite{WikiCodeSmell}. Em particular, Aniche et al. \cite{MvcSmells:16,aniche2016satt} mostraram que a arquitetura do software é um fator importante e que deve ser levada em conta ao analisar a qualidade de um sistema. Outros estudos identificaram cheiros de código específicos Android relacionados ao consumo inteligente de recursos do dispositivo, como bateria e memória, usabilidade, dentre outros \cite{RemovingEnergySmells:12, ReimannBrylski2013}. Verloop \cite{MobileSmells:13} analisou se classes derivadas do SDK Android são mais ou menos propensas a cheiros de código tradicionais do que classes puramente Java. Linares et al. \cite{DomainMatters} usaram o método DECOR para realizar a detecção de 18 \textit{anti-patterns} orientado a objetos em aplicativos móveis.

Umme et al. \cite{Mannan_Dig_Ahmed_Jensen_Abdullah_Almurshed} recentemente levantaram que, das principais conferências de manutenção de software (ICSE, FSE, OOPSLA/SPLASH, ASE, ICSM/ICSME, MRS e ESEM), dentre 2008 a 2015, apenas 10\% dos artigos consideraram em suas pesquisas, projetos Android. Nenhuma outra plataforma móvel foi considerada.  

Nossa pesquisa complementa as anteriores no sentido de que também buscamos por cheiros de código Android. E se difere delas pois buscamos cheiros de código relacionados à qualidade, em termos de manutenabilidade e legibilidade, específico dessa plataforma. Por exemplo \textsc{Activities}, \textsc{Fragments} e \textsc{Adapters} são classes usadas na construção de telas e \textsc{listeners} são responsáveis pelas interações com os usuários. Buscamos entender então quais são as \emph{boas e más} práticas no desenvolvimento da interface visual Android. 


\section{Organização do Trabalho}
As seções seguintes desta dissertação estão organizadas da seguinte forma: 

\begin{itemize}
  \item a Seção \ref{metodologia} aborda a metodologia de pesquisa.

  \item A Seção \ref{resultados} apresenta o catálogo com os XX maus cheiros derivados relacionados ao \textit{front-end} Android.

  \item A Seção \ref{ameacas} aborda as ameaças à validade do estudo.

  \item A Seção \ref{relacionados} discute os trabalhos relacionados e o estado da arte sobre Android e cheiros de código.

  \item E por fim, a Seção \ref{conclusao} conclui.
\end{itemize}


% Para limitar nosso objeto de estudo, optamos por focar em cheiros de código relacionados ao \textit{front-end} Android pois encontramos pesquisas com abordagem similar, porém relacionadas ao \textit{front-end} de tecnologias web, como CSS \cite{CSSCodeSmell}, Javascript \cite{JavascriptSmells} e o arcabouço Spring MVC \cite{FinavaroAniche2016}. 

% \section{Objetivos}


% Para limitar nosso objeto de estudo, optamos por focar em cheiros de código relacionados ao \textit{front-end} Android pois encontramos pesquisas com abordagem similar, porém relacionadas ao \textit{front-end} de tecnologias web, como CSS \cite{CSSCodeSmell}, Javascript \cite{JavascriptSmells} e o arcabouço Spring MVC \cite{FinavaroAniche2016}. 

% E enquanto que cheiros de código em projetos Java já foram extensivamente estudados \cite{Riel:96, Refactoring:99, CleanCode:08}, o \textit{front-end} Android ainda carece de estudo e possui peculiaridades não encontradas em código Java tradicional \cite{Mannan_Dig_Ahmed_Jensen_Abdullah_Almurshed}. Alguns exemplos dessas peculiaridas são o ciclo de vida de \textsc{Activities} e \textsc{Fragments} e a criação da interface visual que é feita através de arquivos XML chamados de \textsc{layout resources}.

% Por meio de um questionário online com perguntas sobre boas e más práticas relacionadas ao \textit{front-end} Android respondido por 45 desenvolvedores, derivamos 23 más práticas. Validamos a percepção dos desenvolvedores sobre essas más práticas através de um experimento com outros 20 desenvolvedores. Os resultados mostram que de fato existem boas e más práticas específicas ao \textit{front-end} Android. Ainda que tenhamos validado com sucesso a percepção dos desenvolvedores sobre apenas duas, esperamos que este catálogo de más práticas possa contribuir com ideias iniciais para outras pesquisas sobre qualidade de codigo em projetos Android.

 % para a definição de cheiros de código e heurísticas para a detecção sistematizada das mesmas em projetos Android, além de contribuir com sugestões de como mitigá-las.


% \begin{enumerate}
% 	\item Catálogo com 23 más práticas no desenvolvimento do \textit{front-end} Android, derivadas a partir dos resultados obtidos com a aplicação de um questionário online respondido por 45 desenvolvedores.
% 	\item A percepção de desenvolvedores sobre as quatro más práticas mais recorrentes através de um questionário online com 11 desenvolvedores..
% 	\item Apêndice online \footnote{Apêndice online: http://suelengc.com/android-code-smells-article} com roteiros dos quetionários e outras informações da pesquisa para que outros pesquisadores possam replicar nosso estudo.
% \end{enumerate}

