% -*- root: dissertation.tex -*-
\section{QP$_2$. Com qual frequência os maus cheiros são percebidos e o quão importante são considerados pelos desenvolvedores?}
\label{phase2-results}

\begin{square}
  \small
  Os maus cheiros derivados são considerados importantes e frequentes no dia a dia do desenvolvimento Android (QP$_2$).
\end{square}


% Participaram desta etapa da pesquisa 201 desenvolvedores de 3 continentes e 14 países diferentes. Brasileiros representam 78\%, e vieram de 18 estados diferentes. Deste modo, apesar da abrangência geográfica, entendemos que os resultados expressam majoritariamente a percepção de desenvolvedores brasileiros. 15\% dos participantes possuem uma ou mais pós-graduações e 61\% são graduados. 57\% possuem de 20 a 35 anos. 

Nossos resultados mostraram que os 21 maus cheiros derivados são considerados, em diferentes níveis, como importantes e se apresentam com diferentes frequências no dia a dia do desenvolvimento Android. A distribuição relativa de frequência para cada frase pode ser vista nos Apêndices \ref{appendix-phase2-frequence-table} (distribuição relativa sobre as afirmações de frequência) e \ref{appendix-phase2-importance-table} (distribuição relativa sobre as afirmações de importância).

% Para os maus cheiros que foram apresentadas no questionário mais de uma afirmação de importância ou frequência, se mostraram com distribuição relativa muito semelhantes, variando de 6\% a no máximo 10\% de uma afirmação a outra.

\subsection{Resultados gerais}
\label{phase2-general-results} 

Para análise dos maus cheiros extraímos dados estatísticos de moda (MO), média (ME) e desvio padrão (DP) de importância e frequência para cada um dos maus cheiros derivados. Utilizamos a MO como um classificador do mau cheiro, ou seja, se ele recebeu majoritariamente a resposta ``importante'', o classificamos como importante. Estes dados são apresentados na Tabela \ref{tab:SmellFrequencyImportance} onde podemos observar que todos os maus cheiros apresentam MO de importância maior ou igual a 3, ou seja, de ``razoavelmente importante'' a ``muito importante''. Em contrapartida, com relação a frequência, três maus cheiros, \textsc{\small Adapter Consumista}, \textsc{\small Listener Escondido} e \textsc{\small Não Uso de Fragment}, apresentaram MO igual a 2, ``raramente'', todos os demais apresentaram MO maior ou igual a 3, ou seja, de ``ás vezes'' até ``muito frequente''. 

Entendemos este resultado de forma positiva pois, apesar de alguns sintomas não serem tão frequentes, ainda assim são considerados com algum nível de importância de se mitigar, reforçando também a relevância desta pesquisa pois damos os primeiros passos no sentido da automatização da identificação desses maus cheiros. Com base no DP, podemos observar que, de modo geral, existe uma concordância maior sobre a importância dos maus cheiros do que sobre a frequência, pois a média do DP de importância é de 1,05, ligeiramente menor que a média do DP de frequência, que é de 1,19. 


\begin{table}[!htb]
\centering
\renewcommand*{\arraystretch}{1}
\footnotesize 
\caption{Média, moda e desvio padrão sobre a percepção da importância dos maus cheiros relacionados a componentes da camada de apresentação Android.}
\begin{tabular}{@{}p{9cm}cccp{.5cm}ccc@{}}
\toprule
\multirow{2}{*}{\textbf{Mau Cheiro}} & \multicolumn{3}{c}{\textbf{Importância}} & & \multicolumn{3}{c}{\textbf{Frequência}} \\ \cmidrule{2-4} \cmidrule{6-8}
                                      & \textbf{ME} & \textbf{MO} & \textbf{DP} & & \textbf{ME} & \textbf{MO} & \textbf{DP} \\
\bottomrule
\textsc{Componente de UI Inteligente} & 5 & 5 & 1,05 & & 3 & 4 & 1,19 \\ 
\textsc{Recurso Mágico} & 4 & 5 & 1,00 & & 3 & 4 & 1,24 \\ 
\textsc{Imagem Tradicional Dispensável} & 4 & 5 & 0,95 & & 3 & 4 & 1,23 \\ 
\textsc{Layout Longo ou Repetido} & 4 & 5 & 0,95 & & 4 & 4 & 1,07 \\ 
\textsc{Imagem Faltante} & 5 & 5 & 0,95 & & 3 & 4 & 1,25 \\ 
\textsc{Componente de UI Acoplado} & 4 & 5 & 1,02 & & 3 & 3 & 1,15 \\ 
\textsc{Classes de UI Fazendo IO} & 5 & 5 & 1,03 & & 3 & 3 & 1,29 \\ 
\textsc{Componente de UI Zumbi} & 5 & 5 & 0,88 & & 3 & 3 & 1,16 \\ 
\textsc{Ausência de Arquitetura} & 5 & 5 & 0,82 & & 3 & 3 & 1,30 \\ 
\textsc{Adapter Complexo} & 4 & 5 & 0,91 & & 3 & 3 & 1,15 \\ 
\textsc{Nome de Recurso Despadronizado} & 5 & 5 & 0,88 & & 3 & 3 & 1,24 \\ 
\textsc{Adapter Consumista} & 5 & 5 & 0,93 & & 2 & 2 & 1,20 \\ 
\textsc{Listener Escondido} & 4 & 5 & 1,23 & & 2 & 2 & 1,29 \\ 
\textsc{Longo Recurso de Estilo} & 4 & 4 & 1,06 & & 4 & 5 & 1,18 \\ 
\textsc{Recurso de String Bagunçado} & 3 & 4 & 1,22 & & 4 & 5 & 1,18 \\ 
\textsc{Comportamento Suspeito} & 3 & 4 & 1,19 & & 3 & 4 & 1,19 \\ 
\textsc{Layout Profundamente Aninhado} & 4 & 4 & 1,12 & & 4 & 4 & 1,06 \\ 
\textsc{Atributos de Estilo Repetidos} & 4 & 4 & 0,86 & & 4 & 4 & 1,11 \\ 
\textsc{Não Uso de Fragment} & 3 & 4 & 1,34 & & 3 & 2 & 1,21 \\ 
\textsc{Reuso Inadequado de String} & 3 & 3 & 1,29 & & 4 & 4 & 1,12 \\ 
\textsc{Uso Excessivo de Fragment} & 3 & 3 & 1,36 & & 3 & 3 & 1,17 \\  
\toprule
DP Médio &  &  & 1.05 &  & &  & 1.19 \\ 
\toprule
\multicolumn{8}{@{}l@{}}{DP = Desvio Padrão, MO = Moda, ME = Média.} \\
\bottomrule
\end{tabular}
\label{tab:SmellFrequencyImportance}
\end{table}

\subsection{Importância dos Maus Cheiros}

Para análise dos dados, simplificamos a escala \textit{likert} de importância de modo que, os maus cheiros de MO 3, ``razoavelmente importante'', são classificados de \textbf{\small importância moderada}, os maus cheiros de MO 4 ou 5, respectivamente ``importante'' e ``muito importante'', são classificados de \textbf{\small importância alta}. Nenhum mau cheiro teve MO 1 ou 2, respectivamente ``não é importante'' e ``pouco importante'', logo, não criamos classificações para essas opções. A Tabela \ref{tab:SmellImportance} apresenta a lista dos maus cheiros de acordo com seu nível de importância, alta ou moderada. 

\begin{table}[!htb]
\centering
\renewcommand*{\arraystretch}{1}
\footnotesize 
\caption{Listagem dos maus cheiros da camada de apresentação Android de acordo com seu nível de importância, alta ou moderada.}
\begin{tabular}{@{}p{5.2cm}p{5.2cm}p{5.2cm}@{}}
\toprule
\multicolumn{2}{c}{\textbf{Importância Alta}} & \multicolumn{1}{c}{\textbf{Importância Moderada}}  \\ 
\bottomrule
\textsc{\scriptsize Adapter Complexo} & \textsc{\scriptsize Atributos de Estilo Repetidos} & \textsc{\scriptsize Reuso Inadequado de String} \\ 
\textsc{\scriptsize Adapter Consumista} & \textsc{\scriptsize Comportamento Suspeito} & \textsc{\scriptsize Uso Excessivo de Fragment} \\ 
\textsc{\scriptsize Ausência de Arquitetura} & \textsc{\scriptsize Layout Profundamente Aninhado} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Classes de UI Fazendo IO} & \textsc{\scriptsize Longo Recurso de Estilo} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Componente de UI Acoplado} & \textsc{\scriptsize Não Uso de Fragment} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Componente de UI Inteligente} & \textsc{\scriptsize Recurso de String Bagunçado} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Componente de UI Zumbi} & \textsc{\scriptsize Imagem Faltante} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Imagem Tradicional Dispensável} & \textsc{\scriptsize Layout Longo ou Repetido} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Listener Escondido} & \textsc{\scriptsize Nome de Recurso Despadronizado} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Recurso Mágico} & \textsc{} & \textsc{} \\ 
\toprule
\multicolumn{2}{c}{19} & \multicolumn{1}{c}{2}  \\ 
\bottomrule
\end{tabular}
\label{tab:SmellImportance}
\end{table}

A Figura \ref{fig:phase2-results-importance} apresenta a distribuição relativa de importância dos maus cheiros. Apresentamos negativo (em vermelho) o percentual relacionado as respostas ``não é importante''. Podemos observar que 19 dos maus cheiros são de \textbf{\small importância alta}, com mais de 47\% das respostas sendo ``importante'' ou ``muito importante''. Apenas 2 maus cheiros são de \textbf{\small importância moderada}, e mesmo quando esta ocorre, a diferença para serem de \textbf{\small importância alta} é baixa. Os maus cheiros que tiveram maior concordância com relação a sua importância, ou seja, DP menor que 1, foram: \textsc{\small Adapter Complexo}, \textsc{\small Adapter Consumista}, \textsc{\small Atributos de Estilo Repetidos}, \textsc{\small Ausência de Arquitetura}, \textsc{\small Componente de UI Zumbi}, \textsc{\small Imagem Faltante}, \textsc{\small Imagem Tradicional Dispensável}, \textsc{\small Layout Longo ou Repetido}, \textsc{\small Nome de Recurso Despadronizado}. .

\begin{figure*}[!htb]
  \centering
  \includegraphics[width=.85\textwidth]{phase2-results-importance.png}
  \caption{Distribuição relativa de importância dos 21 maus cheiros derivados.}
  \label{fig:phase2-results-importance}
  % \vspace{-.5cm} 
\end{figure*}

Os três maus cheiros que obtiveram mais respostas de ``não é importante'' foram: \textsc{\small Reuso Inadequado de String}, \textsc{\small Não Uso de Fragment}, \textsc{\small Uso Excessivo de Fragment}. São os mesmo que tiveram menor concordância com relação a sua importância, todos com DP acima de 1,28.


\subsection{Frequência dos Maus Cheiros}

Para análise dos dados, simplificamos a escala \textit{likert} de frequência de modo similar ao de importância, onde maus cheiros de MO 2, ``raramente'', são classificados como \textbf{\small frequência baixa}, os maus cheiros de MO 3, ``ás vezes'', são classificados como \textbf{\small frequência moderada} e os maus cheiros de MO 4 ou 5, respectivamente ``frequente'' e ``muito frequente'', são classificados de \textbf{\small frequência alta}. Nenhum mau cheiro teve MO 1, ``nunca'', e portanto não criamos classificação para essa opção. A Tabela \ref{tab:SmellFrequency} apresenta a lista dos maus cheiros de acordo com seu nível de frequência, alta, moderada ou baixa. 

\begin{table}[!htb]
\centering
\renewcommand*{\arraystretch}{1}
\footnotesize 
\caption{Listagem dos maus cheiros da camada de apresentação Android de acordo com seu nível de frequência, alta, moderada ou baixa.}
\begin{tabular}{@{}p{5.2cm}p{5.2cm}p{5.2cm}@{}}
\toprule
\multicolumn{1}{c}{\textbf{Frequência Alta}} & \multicolumn{1}{c}{\textbf{Frequência Moderada}} & \multicolumn{1}{c}{\textbf{Frequência Baixa}} \\ 
\bottomrule
\textsc{\scriptsize Atributos de Estilo Repetidos} & \textsc{\scriptsize Adapter Complexo} & \textsc{\scriptsize Adapter Consumista} \\ 
\textsc{\scriptsize Componente de UI Inteligente} & \textsc{\scriptsize Ausência de Arquitetura} & \textsc{\scriptsize Listener Escondido} \\ 
\textsc{\scriptsize Imagem Faltante} & \textsc{\scriptsize Classes de UI Fazendo IO} & \textsc{\scriptsize Não Uso de Fragment} \\ 
\textsc{\scriptsize Imagem Tradicional Dispensável} & \textsc{\scriptsize Componente de UI Acoplado} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Layout Longo ou Repetido} & \textsc{\scriptsize Componente de UI Zumbi} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Layout Profundamente Aninhado} & \textsc{\scriptsize Comportamento Suspeito} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Longo Recurso de Estilo} & \textsc{\scriptsize Nome de Recurso Despadronizado} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Recurso Mágico} & \textsc{\scriptsize Uso Excessivo de Fragment} & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Reuso Inadequado de String} & \textsc{\scriptsize } & \textsc{\scriptsize } \\ 
\textsc{\scriptsize Recurso de String Bagunçado} & \textsc{} & \textsc{} \\ 
\toprule
\multicolumn{1}{c}{10} & \multicolumn{1}{c}{8} & \multicolumn{1}{c}{3}\\ 
\bottomrule
\end{tabular}
\label{tab:SmellFrequency}
\end{table}

É interessante notar que, maus cheiros em recursos são percebidos mais frequentemente que os maus cheiros em componentes da camada de apresentação Android pois, 9 dentre os 10 maus cheiros de \textbf{\small frequência alta} são em recursos Android. Nos demais níveis de frequência, os maus cheiros em componentes são maioria, sendo 7 dentre os 8 de \textbf{\small frequência moderada} e 2 dentre os 3 de \textbf{\small frequência baixa}.

A Figura \ref{fig:phase2-results-importance} apresenta a distribuição relativa de frequência dos maus cheiros. Apresentamos negativo (em vermelho) o percentual relacionado as respostas ``nunca''. Podemos observar que 10 dos maus cheiros são de \textbf{\small frequência alta}, com mais de 39\% das respostas sendo ``frequente'' ou ``muito frequente''. 8 maus cheiros são de \textbf{\small frequência moderada}, tendo obtido mais de 27\% das respostas ``ás vezes'' e apenas 3 maus cheiros são de \textbf{\small frequência baixa} com mais de 29\% das respostas sendo ``raramente''. Nenhum dos maus cheiros obteve DP menor que 1, mas os mais próximos, indicando maior concordância sobre sua frequência são os \textsc{\small Layout Profundamente Aninhado} com DP de 1,06 e \textsc{\small Longo Recurso de Estilo} com DP 1,07.

\begin{figure*}[!t]
  \centering
  \includegraphics[width=.85\textwidth]{phase2-results-frequence.png}
  \caption{Distribuição relativa de frequência dos 21 maus cheiros derivados.}
  \label{fig:phase2-survey-frequence-java}
  % \vspace{-.5cm} 
\end{figure*}


